# AutoCad_project

  Индивидуальный проект под личные задачи. Предназначено для ускорения работы с конструкторскими чертежами. Машинное обучение позволит убрать рутинные операции. Требования - винда и автокад. На линуксе, к сожалению, автокад не работает, правда можно извратиться с виртуалкой, если хочется.

  Задачи:
  ## **1. Обеспечить работу с AutoCAD на Python.**
  Автокад по умолчанию не дружит с питоном. Для решения проблемы использовались  COM-объекты и всякие win32 либы. Опыт негативный - далеко не все данные объектов можно достать таким образом. Например, в одном виде размеров появляется функция передачи координат на которых они стоят, на другом типе их нет. Поэтому используется преобразование чертежа в текстовой DXF файл, из которого в текстовом виде достаются нужные данные, и далее производится их обработка.  
  
  ## **2. ML часть(в разработке)**
  Программа должна проставлять размеры на точки крепления к приборам, с учётом всех требований ЕСКД и располагая их в правильном положении относительно друг друга. С имеющейся базой можно расширить применение на другие задачи работы с dwg чертежами.

  Проект читает хорошие чертежи, обучается на существующих позициях размеров. Фичи - данные о линиях в слое с точками крепления, пересечение с линиями прибора, и т. д. Target - базовые точки размеров, положение текста размера

  "Демонстрационная" первая версия: будет один вид, нужно проставить все размеры на 1 виде.

  Работа тестируется на файле train.dwg. Предварительно нужно открыть его у автокаде, т.к. возможно читать только активный документ автокада.
  
  
   ### Условия:
   
  - ~~Размеры линейные, aligned dimensions.~~ Теперь поддерживаются любые типы размеров, да и вообще любые объекты
  - Один вид
  - Фиксированные значения длин линий точек привязки для размеров.
  - Строго определённые слои для разных объектов. Это требование должно выполняться и в итоговой версии, как и чистота и правильность всех чертежей.
  
  
   ### Решённые на данный момент задачи:  
  - Чтение dwg файла средствами python, через com объекты. 
  - Чтение данных всего чертежа (DXF-формат) и извлечение из него нужной информации.
  - Возможность взрывать блоки.
  - Извлечение координат точек крепления приборов, формирование датафрейма с данными для каждого прибора.
  - Формирование датафрейма с фичами размеров- координаты точек привязки и текста размера.
 

  
    ### Необходимо реализовать:
   - Линии приборов в датафрейме приборов
   - Модель машинного обучения по собранным координатам объектов
